{
  "version": "5",
  "dialect": "mysql",
  "id": "a12c8e80-5266-4d21-b1ad-6b1bd2c44517",
  "prevId": "6daa10a7-0a9a-408d-992d-05437602d6a1",
  "tables": {
    "analyst_notes": {
      "name": "analyst_notes",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "title": {
          "name": "title",
          "type": "varchar(512)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "content": {
          "name": "content",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "severity": {
          "name": "severity",
          "type": "enum('critical','high','medium','low','info')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'info'"
        },
        "agentId": {
          "name": "agentId",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "ruleId": {
          "name": "ruleId",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "cveId": {
          "name": "cveId",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "tags": {
          "name": "tags",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "resolved": {
          "name": "resolved",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": 0
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "analyst_notes_id": {
          "name": "analyst_notes_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "analyst_notes_v2": {
      "name": "analyst_notes_v2",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "userId": {
          "name": "userId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "entityType": {
          "name": "entityType",
          "type": "enum('alert','agent','cve','rule','general')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "entityId": {
          "name": "entityId",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "''"
        },
        "title": {
          "name": "title",
          "type": "varchar(512)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "content": {
          "name": "content",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "severity": {
          "name": "severity",
          "type": "enum('critical','high','medium','low','info')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'info'"
        },
        "tags": {
          "name": "tags",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "resolved": {
          "name": "resolved",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": 0
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        }
      },
      "indexes": {
        "notes_v2_userId_idx": {
          "name": "notes_v2_userId_idx",
          "columns": [
            "userId"
          ],
          "isUnique": false
        },
        "notes_v2_entityType_idx": {
          "name": "notes_v2_entityType_idx",
          "columns": [
            "entityType"
          ],
          "isUnique": false
        },
        "notes_v2_entityId_idx": {
          "name": "notes_v2_entityId_idx",
          "columns": [
            "entityId"
          ],
          "isUnique": false
        },
        "notes_v2_entity_lookup_idx": {
          "name": "notes_v2_entity_lookup_idx",
          "columns": [
            "entityType",
            "entityId"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "analyst_notes_v2_id": {
          "name": "analyst_notes_v2_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "config_baselines": {
      "name": "config_baselines",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "userId": {
          "name": "userId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "name": {
          "name": "name",
          "type": "varchar(256)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "agentIds": {
          "name": "agentIds",
          "type": "json",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "snapshotData": {
          "name": "snapshotData",
          "type": "json",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "config_baselines_id": {
          "name": "config_baselines_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "graph_endpoints": {
      "name": "graph_endpoints",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "agentId": {
          "name": "agentId",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "hostname": {
          "name": "hostname",
          "type": "varchar(256)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "ipAddress": {
          "name": "ipAddress",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "osName": {
          "name": "osName",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "osVersion": {
          "name": "osVersion",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "osPlatform": {
          "name": "osPlatform",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "architecture": {
          "name": "architecture",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "agentVersion": {
          "name": "agentVersion",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "agentStatus": {
          "name": "agentStatus",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "lastKeepAlive": {
          "name": "lastKeepAlive",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "syncedAt": {
          "name": "syncedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {
        "ge_agentId_idx": {
          "name": "ge_agentId_idx",
          "columns": [
            "agentId"
          ],
          "isUnique": false
        },
        "ge_hostname_idx": {
          "name": "ge_hostname_idx",
          "columns": [
            "hostname"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "graph_endpoints_id": {
          "name": "graph_endpoints_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "graph_endpoints_agentId_unique": {
          "name": "graph_endpoints_agentId_unique",
          "columns": [
            "agentId"
          ]
        }
      },
      "checkConstraint": {}
    },
    "graph_identities": {
      "name": "graph_identities",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "endpointId": {
          "name": "endpointId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "username": {
          "name": "username",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "uid": {
          "name": "uid",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "gid": {
          "name": "gid",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "homeDir": {
          "name": "homeDir",
          "type": "varchar(512)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "shell": {
          "name": "shell",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "isAdmin": {
          "name": "isAdmin",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": 0
        },
        "userType": {
          "name": "userType",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "syncedAt": {
          "name": "syncedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {
        "gi_endpointId_idx": {
          "name": "gi_endpointId_idx",
          "columns": [
            "endpointId"
          ],
          "isUnique": false
        },
        "gi_username_idx": {
          "name": "gi_username_idx",
          "columns": [
            "username"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "graph_identities_id": {
          "name": "graph_identities_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "graph_network_ports": {
      "name": "graph_network_ports",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "endpointId": {
          "name": "endpointId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "processId": {
          "name": "processId",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "localPort": {
          "name": "localPort",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "localIp": {
          "name": "localIp",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "remoteIp": {
          "name": "remoteIp",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "remotePort": {
          "name": "remotePort",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "protocol": {
          "name": "protocol",
          "type": "varchar(16)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "state": {
          "name": "state",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "syncedAt": {
          "name": "syncedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {
        "gnp_endpointId_idx": {
          "name": "gnp_endpointId_idx",
          "columns": [
            "endpointId"
          ],
          "isUnique": false
        },
        "gnp_localPort_idx": {
          "name": "gnp_localPort_idx",
          "columns": [
            "localPort"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "graph_network_ports_id": {
          "name": "graph_network_ports_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "graph_processes": {
      "name": "graph_processes",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "endpointId": {
          "name": "endpointId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "processName": {
          "name": "processName",
          "type": "varchar(256)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "pid": {
          "name": "pid",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "ppid": {
          "name": "ppid",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "state": {
          "name": "state",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "userName": {
          "name": "userName",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "cmdLine": {
          "name": "cmdLine",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "syncedAt": {
          "name": "syncedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {
        "gp_endpointId_idx": {
          "name": "gp_endpointId_idx",
          "columns": [
            "endpointId"
          ],
          "isUnique": false
        },
        "gp_processName_idx": {
          "name": "gp_processName_idx",
          "columns": [
            "processName"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "graph_processes_id": {
          "name": "graph_processes_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "graph_security_events": {
      "name": "graph_security_events",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "endpointId": {
          "name": "endpointId",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "alertId": {
          "name": "alertId",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "ruleId": {
          "name": "ruleId",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "ruleLevel": {
          "name": "ruleLevel",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "ruleDescription": {
          "name": "ruleDescription",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "mitreTactic": {
          "name": "mitreTactic",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "mitreTechnique": {
          "name": "mitreTechnique",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "mitreId": {
          "name": "mitreId",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "agentId": {
          "name": "agentId",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "agentName": {
          "name": "agentName",
          "type": "varchar(256)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "srcIp": {
          "name": "srcIp",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "dstIp": {
          "name": "dstIp",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "eventTimestamp": {
          "name": "eventTimestamp",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "rawData": {
          "name": "rawData",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "syncedAt": {
          "name": "syncedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {
        "gse_endpointId_idx": {
          "name": "gse_endpointId_idx",
          "columns": [
            "endpointId"
          ],
          "isUnique": false
        },
        "gse_ruleId_idx": {
          "name": "gse_ruleId_idx",
          "columns": [
            "ruleId"
          ],
          "isUnique": false
        },
        "gse_mitreTactic_idx": {
          "name": "gse_mitreTactic_idx",
          "columns": [
            "mitreTactic"
          ],
          "isUnique": false
        },
        "gse_agentId_idx": {
          "name": "gse_agentId_idx",
          "columns": [
            "agentId"
          ],
          "isUnique": false
        },
        "gse_eventTimestamp_idx": {
          "name": "gse_eventTimestamp_idx",
          "columns": [
            "eventTimestamp"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "graph_security_events_id": {
          "name": "graph_security_events_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "graph_software_packages": {
      "name": "graph_software_packages",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "endpointId": {
          "name": "endpointId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "packageName": {
          "name": "packageName",
          "type": "varchar(256)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "version": {
          "name": "version",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "architecture": {
          "name": "architecture",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "vendor": {
          "name": "vendor",
          "type": "varchar(256)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "format": {
          "name": "format",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "syncedAt": {
          "name": "syncedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {
        "gsp_endpointId_idx": {
          "name": "gsp_endpointId_idx",
          "columns": [
            "endpointId"
          ],
          "isUnique": false
        },
        "gsp_packageName_idx": {
          "name": "gsp_packageName_idx",
          "columns": [
            "packageName"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "graph_software_packages_id": {
          "name": "graph_software_packages_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "graph_sync_status": {
      "name": "graph_sync_status",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "entityType": {
          "name": "entityType",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "lastSyncAt": {
          "name": "lastSyncAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "entityCount": {
          "name": "entityCount",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": 0
        },
        "status": {
          "name": "status",
          "type": "enum('idle','syncing','completed','error')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'idle'"
        },
        "errorMessage": {
          "name": "errorMessage",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "durationMs": {
          "name": "durationMs",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "graph_sync_status_id": {
          "name": "graph_sync_status_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "graph_sync_status_entityType_unique": {
          "name": "graph_sync_status_entityType_unique",
          "columns": [
            "entityType"
          ]
        }
      },
      "checkConstraint": {}
    },
    "graph_vulnerabilities": {
      "name": "graph_vulnerabilities",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "endpointId": {
          "name": "endpointId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "packageId": {
          "name": "packageId",
          "type": "int",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "cveId": {
          "name": "cveId",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "cvssScore": {
          "name": "cvssScore",
          "type": "varchar(8)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "severity": {
          "name": "severity",
          "type": "varchar(16)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "status": {
          "name": "status",
          "type": "varchar(32)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "packageName": {
          "name": "packageName",
          "type": "varchar(256)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "packageVersion": {
          "name": "packageVersion",
          "type": "varchar(128)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "title": {
          "name": "title",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "publishedAt": {
          "name": "publishedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "detectedAt": {
          "name": "detectedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "syncedAt": {
          "name": "syncedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {
        "gv_endpointId_idx": {
          "name": "gv_endpointId_idx",
          "columns": [
            "endpointId"
          ],
          "isUnique": false
        },
        "gv_cveId_idx": {
          "name": "gv_cveId_idx",
          "columns": [
            "cveId"
          ],
          "isUnique": false
        },
        "gv_severity_idx": {
          "name": "gv_severity_idx",
          "columns": [
            "severity"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "graph_vulnerabilities_id": {
          "name": "graph_vulnerabilities_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "investigation_notes": {
      "name": "investigation_notes",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "sessionId": {
          "name": "sessionId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "userId": {
          "name": "userId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "content": {
          "name": "content",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        }
      },
      "indexes": {
        "in_sessionId_idx": {
          "name": "in_sessionId_idx",
          "columns": [
            "sessionId"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "investigation_notes_id": {
          "name": "investigation_notes_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "investigation_sessions": {
      "name": "investigation_sessions",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "userId": {
          "name": "userId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "title": {
          "name": "title",
          "type": "varchar(512)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "status": {
          "name": "status",
          "type": "enum('active','closed','archived')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'active'"
        },
        "evidence": {
          "name": "evidence",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "timeline": {
          "name": "timeline",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "tags": {
          "name": "tags",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        }
      },
      "indexes": {
        "is_userId_idx": {
          "name": "is_userId_idx",
          "columns": [
            "userId"
          ],
          "isUnique": false
        },
        "is_status_idx": {
          "name": "is_status_idx",
          "columns": [
            "status"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "investigation_sessions_id": {
          "name": "investigation_sessions_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "rag_sessions": {
      "name": "rag_sessions",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "sessionId": {
          "name": "sessionId",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "role": {
          "name": "role",
          "type": "enum('user','assistant','system')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "content": {
          "name": "content",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "contextSnapshot": {
          "name": "contextSnapshot",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "rag_sessions_id": {
          "name": "rag_sessions_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "saved_searches": {
      "name": "saved_searches",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "userId": {
          "name": "userId",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "name": {
          "name": "name",
          "type": "varchar(256)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "searchType": {
          "name": "searchType",
          "type": "enum('siem','hunting')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "filters": {
          "name": "filters",
          "type": "json",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "saved_searches_id": {
          "name": "saved_searches_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "users": {
      "name": "users",
      "columns": {
        "id": {
          "name": "id",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": true
        },
        "openId": {
          "name": "openId",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "email": {
          "name": "email",
          "type": "varchar(320)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "loginMethod": {
          "name": "loginMethod",
          "type": "varchar(64)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "passwordHash": {
          "name": "passwordHash",
          "type": "varchar(256)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "role": {
          "name": "role",
          "type": "enum('user','admin')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'user'"
        },
        "isDisabled": {
          "name": "isDisabled",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": 0
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        },
        "lastSignedIn": {
          "name": "lastSignedIn",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "users_id": {
          "name": "users_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "users_openId_unique": {
          "name": "users_openId_unique",
          "columns": [
            "openId"
          ]
        }
      },
      "checkConstraint": {}
    }
  },
  "views": {},
  "_meta": {
    "schemas": {},
    "tables": {},
    "columns": {}
  },
  "internal": {
    "tables": {},
    "indexes": {}
  }
}