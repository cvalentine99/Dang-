{
  "query": "CREATE TABLE `graph_endpoints` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`agentId` varchar(32) NOT NULL,\n\t`hostname` varchar(256),\n\t`ipAddress` varchar(64),\n\t`osName` varchar(128),\n\t`osVersion` varchar(128),\n\t`osPlatform` varchar(64),\n\t`architecture` varchar(32),\n\t`agentVersion` varchar(64),\n\t`agentStatus` varchar(32),\n\t`lastKeepAlive` timestamp,\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_endpoints_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `graph_endpoints_agentId_unique` UNIQUE(`agentId`)\n);\nCREATE TABLE `graph_identities` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int NOT NULL,\n\t`username` varchar(128) NOT NULL,\n\t`uid` varchar(32),\n\t`gid` varchar(32),\n\t`homeDir` varchar(512),\n\t`shell` varchar(128),\n\t`isAdmin` int NOT NULL DEFAULT 0,\n\t`userType` varchar(32),\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_identities_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `graph_network_ports` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int NOT NULL,\n\t`processId` int,\n\t`localPort` int NOT NULL,\n\t`localIp` varchar(64),\n\t`remoteIp` varchar(64),\n\t`remotePort` int,\n\t`protocol` varchar(16),\n\t`state` varchar(32),\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_network_ports_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `graph_processes` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int NOT NULL,\n\t`processName` varchar(256) NOT NULL,\n\t`pid` int,\n\t`ppid` int,\n\t`state` varchar(32),\n\t`userName` varchar(128),\n\t`cmdLine` text,\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_processes_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `graph_security_events` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int,\n\t`alertId` varchar(64),\n\t`ruleId` varchar(32) NOT NULL,\n\t`ruleLevel` int,\n\t`ruleDescription` text,\n\t`mitreTactic` varchar(128),\n\t`mitreTechnique` varchar(128),\n\t`mitreId` varchar(32),\n\t`agentId` varchar(32),\n\t`agentName` varchar(256),\n\t`srcIp` varchar(64),\n\t`dstIp` varchar(64),\n\t`eventTimestamp` timestamp,\n\t`rawData` json,\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_security_events_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `graph_software_packages` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int NOT NULL,\n\t`packageName` varchar(256) NOT NULL,\n\t`version` varchar(128),\n\t`architecture` varchar(32),\n\t`vendor` varchar(256),\n\t`format` varchar(32),\n\t`description` text,\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_software_packages_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `graph_sync_status` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`entityType` varchar(64) NOT NULL,\n\t`lastSyncAt` timestamp,\n\t`entityCount` int NOT NULL DEFAULT 0,\n\t`status` enum('idle','syncing','completed','error') NOT NULL DEFAULT 'idle',\n\t`errorMessage` text,\n\t`durationMs` int,\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `graph_sync_status_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `graph_sync_status_entityType_unique` UNIQUE(`entityType`)\n);\nCREATE TABLE `graph_vulnerabilities` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int NOT NULL,\n\t`packageId` int,\n\t`cveId` varchar(32) NOT NULL,\n\t`cvssScore` varchar(8),\n\t`severity` varchar(16),\n\t`status` varchar(32),\n\t`packageName` varchar(256),\n\t`packageVersion` varchar(128),\n\t`title` text,\n\t`publishedAt` timestamp,\n\t`detectedAt` timestamp,\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_vulnerabilities_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `investigation_notes` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`sessionId` int NOT NULL,\n\t`userId` int NOT NULL,\n\t`content` text NOT NULL,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `investigation_notes_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `investigation_sessions` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`userId` int NOT NULL,\n\t`title` varchar(512) NOT NULL,\n\t`description` text,\n\t`status` enum('active','closed','archived') NOT NULL DEFAULT 'active',\n\t`evidence` json,\n\t`timeline` json,\n\t`tags` json,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `investigation_sessions_id` PRIMARY KEY(`id`)\n);\nCREATE INDEX `ge_agentId_idx` ON `graph_endpoints` (`agentId`);\nCREATE INDEX `ge_hostname_idx` ON `graph_endpoints` (`hostname`);\nCREATE INDEX `gi_endpointId_idx` ON `graph_identities` (`endpointId`);\nCREATE INDEX `gi_username_idx` ON `graph_identities` (`username`);\nCREATE INDEX `gnp_endpointId_idx` ON `graph_network_ports` (`endpointId`);\nCREATE INDEX `gnp_localPort_idx` ON `graph_network_ports` (`localPort`);\nCREATE INDEX `gp_endpointId_idx` ON `graph_processes` (`endpointId`);\nCREATE INDEX `gp_processName_idx` ON `graph_processes` (`processName`);\nCREATE INDEX `gse_endpointId_idx` ON `graph_security_events` (`endpointId`);\nCREATE INDEX `gse_ruleId_idx` ON `graph_security_events` (`ruleId`);\nCREATE INDEX `gse_mitreTactic_idx` ON `graph_security_events` (`mitreTactic`);\nCREATE INDEX `gse_agentId_idx` ON `graph_security_events` (`agentId`);\nCREATE INDEX `gse_eventTimestamp_idx` ON `graph_security_events` (`eventTimestamp`);\nCREATE INDEX `gsp_endpointId_idx` ON `graph_software_packages` (`endpointId`);\nCREATE INDEX `gsp_packageName_idx` ON `graph_software_packages` (`packageName`);\nCREATE INDEX `gv_endpointId_idx` ON `graph_vulnerabilities` (`endpointId`);\nCREATE INDEX `gv_cveId_idx` ON `graph_vulnerabilities` (`cveId`);\nCREATE INDEX `gv_severity_idx` ON `graph_vulnerabilities` (`severity`);\nCREATE INDEX `in_sessionId_idx` ON `investigation_notes` (`sessionId`);\nCREATE INDEX `is_userId_idx` ON `investigation_sessions` (`userId`);\nCREATE INDEX `is_status_idx` ON `investigation_sessions` (`status`);",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 3xenzgJ3NGNThF2.96bc46f6ec2f --database 9n2ukZGVgWAjZMdS2ZS3BU --execute CREATE TABLE `graph_endpoints` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`agentId` varchar(32) NOT NULL,\n\t`hostname` varchar(256),\n\t`ipAddress` varchar(64),\n\t`osName` varchar(128),\n\t`osVersion` varchar(128),\n\t`osPlatform` varchar(64),\n\t`architecture` varchar(32),\n\t`agentVersion` varchar(64),\n\t`agentStatus` varchar(32),\n\t`lastKeepAlive` timestamp,\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_endpoints_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `graph_endpoints_agentId_unique` UNIQUE(`agentId`)\n);\nCREATE TABLE `graph_identities` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int NOT NULL,\n\t`username` varchar(128) NOT NULL,\n\t`uid` varchar(32),\n\t`gid` varchar(32),\n\t`homeDir` varchar(512),\n\t`shell` varchar(128),\n\t`isAdmin` int NOT NULL DEFAULT 0,\n\t`userType` varchar(32),\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_identities_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `graph_network_ports` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int NOT NULL,\n\t`processId` int,\n\t`localPort` int NOT NULL,\n\t`localIp` varchar(64),\n\t`remoteIp` varchar(64),\n\t`remotePort` int,\n\t`protocol` varchar(16),\n\t`state` varchar(32),\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_network_ports_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `graph_processes` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int NOT NULL,\n\t`processName` varchar(256) NOT NULL,\n\t`pid` int,\n\t`ppid` int,\n\t`state` varchar(32),\n\t`userName` varchar(128),\n\t`cmdLine` text,\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_processes_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `graph_security_events` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int,\n\t`alertId` varchar(64),\n\t`ruleId` varchar(32) NOT NULL,\n\t`ruleLevel` int,\n\t`ruleDescription` text,\n\t`mitreTactic` varchar(128),\n\t`mitreTechnique` varchar(128),\n\t`mitreId` varchar(32),\n\t`agentId` varchar(32),\n\t`agentName` varchar(256),\n\t`srcIp` varchar(64),\n\t`dstIp` varchar(64),\n\t`eventTimestamp` timestamp,\n\t`rawData` json,\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_security_events_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `graph_software_packages` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int NOT NULL,\n\t`packageName` varchar(256) NOT NULL,\n\t`version` varchar(128),\n\t`architecture` varchar(32),\n\t`vendor` varchar(256),\n\t`format` varchar(32),\n\t`description` text,\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_software_packages_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `graph_sync_status` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`entityType` varchar(64) NOT NULL,\n\t`lastSyncAt` timestamp,\n\t`entityCount` int NOT NULL DEFAULT 0,\n\t`status` enum('idle','syncing','completed','error') NOT NULL DEFAULT 'idle',\n\t`errorMessage` text,\n\t`durationMs` int,\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `graph_sync_status_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `graph_sync_status_entityType_unique` UNIQUE(`entityType`)\n);\nCREATE TABLE `graph_vulnerabilities` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`endpointId` int NOT NULL,\n\t`packageId` int,\n\t`cveId` varchar(32) NOT NULL,\n\t`cvssScore` varchar(8),\n\t`severity` varchar(16),\n\t`status` varchar(32),\n\t`packageName` varchar(256),\n\t`packageVersion` varchar(128),\n\t`title` text,\n\t`publishedAt` timestamp,\n\t`detectedAt` timestamp,\n\t`syncedAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graph_vulnerabilities_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `investigation_notes` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`sessionId` int NOT NULL,\n\t`userId` int NOT NULL,\n\t`content` text NOT NULL,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `investigation_notes_id` PRIMARY KEY(`id`)\n);\nCREATE TABLE `investigation_sessions` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`userId` int NOT NULL,\n\t`title` varchar(512) NOT NULL,\n\t`description` text,\n\t`status` enum('active','closed','archived') NOT NULL DEFAULT 'active',\n\t`evidence` json,\n\t`timeline` json,\n\t`tags` json,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `investigation_sessions_id` PRIMARY KEY(`id`)\n);\nCREATE INDEX `ge_agentId_idx` ON `graph_endpoints` (`agentId`);\nCREATE INDEX `ge_hostname_idx` ON `graph_endpoints` (`hostname`);\nCREATE INDEX `gi_endpointId_idx` ON `graph_identities` (`endpointId`);\nCREATE INDEX `gi_username_idx` ON `graph_identities` (`username`);\nCREATE INDEX `gnp_endpointId_idx` ON `graph_network_ports` (`endpointId`);\nCREATE INDEX `gnp_localPort_idx` ON `graph_network_ports` (`localPort`);\nCREATE INDEX `gp_endpointId_idx` ON `graph_processes` (`endpointId`);\nCREATE INDEX `gp_processName_idx` ON `graph_processes` (`processName`);\nCREATE INDEX `gse_endpointId_idx` ON `graph_security_events` (`endpointId`);\nCREATE INDEX `gse_ruleId_idx` ON `graph_security_events` (`ruleId`);\nCREATE INDEX `gse_mitreTactic_idx` ON `graph_security_events` (`mitreTactic`);\nCREATE INDEX `gse_agentId_idx` ON `graph_security_events` (`agentId`);\nCREATE INDEX `gse_eventTimestamp_idx` ON `graph_security_events` (`eventTimestamp`);\nCREATE INDEX `gsp_endpointId_idx` ON `graph_software_packages` (`endpointId`);\nCREATE INDEX `gsp_packageName_idx` ON `graph_software_packages` (`packageName`);\nCREATE INDEX `gv_endpointId_idx` ON `graph_vulnerabilities` (`endpointId`);\nCREATE INDEX `gv_cveId_idx` ON `graph_vulnerabilities` (`cveId`);\nCREATE INDEX `gv_severity_idx` ON `graph_vulnerabilities` (`severity`);\nCREATE INDEX `in_sessionId_idx` ON `investigation_notes` (`sessionId`);\nCREATE INDEX `is_userId_idx` ON `investigation_sessions` (`userId`);\nCREATE INDEX `is_status_idx` ON `investigation_sessions` (`status`);",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 13975
}